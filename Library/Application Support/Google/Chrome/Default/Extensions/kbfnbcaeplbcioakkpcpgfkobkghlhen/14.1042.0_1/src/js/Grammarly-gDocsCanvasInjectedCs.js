!function(){Error;function e(t,n,o){const r=o();return t>0?r.catch((r=>new Promise(((e,t)=>setTimeout(e,n))).then((r=>e(t-1,n,o))))):r}var t;!function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}e.create=function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}(t||(t={}));void 0!==self.requestIdleCallback&&self.requestIdleCallback;function n(e){return new Promise((t=>setTimeout(t,e)))}const o=n;const r=function(){let e,t;return{promise:new Promise(((n,o)=>{e=n,t=o})),resolve:e,reject:t}};var i,s,a,l,c,u;!function(e){function t(e){return new Promise(e)}e.create=t,e.createCompletionSource=r,e.sync=function(e){return t(((t,n)=>t(e())))},e.delay=o}(i||(i={}));class d extends Error{}function g(e){return new Promise(((t,n)=>setTimeout((()=>n(new d("Promise timed out."))),e)))}function p(e){return e.nodeType===Node.ELEMENT_NODE}!function(e){e[e.Escape=27]="Escape",e[e.Return=13]="Return",e[e.Tab=9]="Tab",e[e.RightArrow=39]="RightArrow",e[e.UpArrow=38]="UpArrow",e[e.DownArrow=40]="DownArrow"}(s||(s={})),function(e){e.editorElementClass="kix-appview-editor",e.layoutRootClass="kix-zoomdocumentplugin-outer",e.contentRootClass="kix-paginateddocumentplugin",e.wordNodeClass="kix-wordhtmlgenerator-word-node",e.commentContainerClass="docos-input",e.viewModeIconClass="docs-icon-acl-view-only-on-brand-color-background",e.eventsIFrameSelector=".docs-texteventtarget-iframe",e.selectionOverlaySelector=".kix-selection-overlay",e.cursor=".kix-cursor",e.cursor_rectangle=".kix-cursor-caret",e.cursor_active="docs-text-ui-cursor-blink",e.versionHistorySidebarSelector="#docs-revisions-sidebar",e.viewModeMenuSelector=".docs-toolbar-menu-button .docs-icon-acl-view-only",e.requestEditAccessButtonSelector="#titlebar-mode-indicator-container .kix-titlebar-request-access-button",e.lineViewDecorationsSelector=".kix-lineview-decorations",e.suggestionNewTextSelector='[class*="suggestion-text"]',e.suggestionOverlaySelector=".suggest-changes-top-colorbar",e.smartComposeSelector=".docs-smartcompose-suggestion",e.canvasSelector="canvas.kix-canvas-tile-content",e.canvasLayoutRootClass="kix-rotatingtilemanager"}(a||(a={})),function(e){e.gdocsPageClass="kix-page",e.gdocsColumnClass="kix-page-column",e.gdocsColumnBottomClass="kix-page-column-bottom",e.gdocsFootNoteClass="kix-paginated-footnoteview",e.gdocsParagraphClass="kix-paragraphrenderer",e.gdocsTableClass="kix-tablerenderer",e.gdocsTableCellClass="kix-cellrenderer",e.lineTextClass="kix-lineview-text-block",e.wordNodeClass="kix-wordhtmlgenerator-word-node",e.inlineBlockClass="goog-inline-block",e.personEntityViewClass="kix-person-entity-view",e.personEntityNameClass="kix-person-entity-name",e.gdocsContentParagraphSelector=`.${e.gdocsColumnClass} .${e.gdocsParagraphClass}`,e.isContinuationParagraphContent=e=>{if(e){const t=e.closest(".kix-paragraphrenderer");return t&&!t.hasAttribute("id")}return null},e.isSplitTailParagraph=e=>p(e)&&!e.hasAttribute("id")}(l||(l={})),function(e){e.lineViewSelector="div.kix-lineview",e.spellingOverlaySelector="div.kix-spelling-error-overlay-container.kix-htmloverlay.docs-ui-unprintable",e.spellingUnderlineSelector="svg.kix-spelling-error-overlay",e.spellingBubbleSelector="div.kix-spell-bubble",e.spellingHighlightSelectors=["div.kix-spelling-error-highlighted-overlay","div.kix-spelling-error-highlighted-overlay-non-critical"],e.sellingUnderlinePromoBubbleSelector="div.jfk-bubble.jfk-bubble-promo.docs-promo-bubble"}(c||(c={})),function(e){function t(e){return p(e)&&e.classList.contains(l.gdocsParagraphClass)}function n(e){return p(e)&&e.classList.contains(l.gdocsTableClass)}e.isPage=function(e){return p(e)&&e.classList.contains(l.gdocsPageClass)},e.isPageLoaded=function(e){return e.querySelectorAll(l.gdocsContentParagraphSelector).length>0},e.isColumn=function(e){return p(e)&&e.classList.contains(l.gdocsColumnClass)},e.isColumnBottom=function(e){return p(e)&&e.classList.contains(l.gdocsColumnBottomClass)},e.isFootNote=function(e){return p(e)&&e.classList.contains(l.gdocsFootNoteClass)},e.isParagraph=t,e.isTable=n,e.isTableRow=function(e){return p(e)&&"tr"===e.tagName.toLowerCase()},e.isTableCellHolder=function(e){return p(e)&&"td"===e.tagName.toLocaleLowerCase()},e.isTableCellContent=function(e){return p(e)&&e.classList.contains(l.gdocsTableCellClass)},e.isContent=function(e){return t(e)||n(e)},e.isParagraphLine=function(e){return p(e)&&e.classList.contains(l.lineTextClass)},e.isWordNode=function(e){return p(e)&&e.classList.contains(l.wordNodeClass)},e.isTextNode=function(e){return e.nodeType===Node.TEXT_NODE},e.isNBSPNode=function(e){return p(e)&&e.classList.contains(l.inlineBlockClass)&&e.textContent===String.fromCharCode(160)},e.isPersonEntityView=function(e){return p(e)&&e.classList.contains(l.personEntityViewClass)},e.isPersonEntityName=function(e){return p(e)&&e.classList.contains(l.personEntityNameClass)}}(u||(u={}));class h{constructor(e,t,n,o){this._customInboundEventName=t,this._customOutboundEventName=n,this._wrapOutboundMessage=o,this.inbound={subscribe:e=>{const t=({detail:t})=>{const n=t;e&&("function"==typeof e?e(n):e.next&&e.next(n))};return this._target.addEventListener(this._customInboundEventName,t,!1),{unsubscribe:()=>this._target.removeEventListener(this._customInboundEventName,t,!1)}}},this.outbound=e=>{const t=this._wrapOutboundMessage?this._wrapOutboundMessage(e):e,n=new CustomEvent(this._customOutboundEventName,{bubbles:!0,cancelable:!0,detail:t});this._target.dispatchEvent(n)},this._target=e.defaultView||e}}function f(e,t,n=Number.EPSILON){return function(e,t,n=Number.EPSILON){return e>=t||e+n>=t}(t,e,n)}function m(e,t,n){return{call(o,r,i,s){var a;const l=s(i),c=null===(a=t.postFn)||void 0===a?void 0:a[r];if(c)try{c(o,e,i,l)}catch(e){n.logException(`proxy.call.${String(r)}`,e)}return l},set(o,r,i,s){var a;const l=null===(a=t.overrideSet)||void 0===a?void 0:a[r];if(l)try{const t=l(o,e,i);if(void 0!==t)return s(t)}catch(e){n.logException(`proxy.set.${String(r)}`,e)}return s(i)}}}const b="M";function y(e){const t=/^(?:([\d\w]+) )?(?:(\w+) )?([\d\.]+)px (?:[\'\"])?([\w \-]+)(?:[\'\"])?$/.exec(e);if(t){const[e,n,o,r,i]=t;let s="400",a="normal";return n&&(isNaN(parseInt(n,10))?"italic"===n?(a="italic",s=isNaN(parseInt(o,10))?"bold"===o?"700":"400":o):s="bold"===n?"700":"400":(s=n,a=o||a)),`${s} ${a} ${parseFloat(r).toFixed(4)}px "${i}"`}return e}var w,x;function v(e){return e.type===w.text}function C(e,t,n){const o=new DOMPoint(e,t).matrixTransform(n);return{left:o.x,top:o.y}}function N(e,t,n){return{width:n.a*e+n.c*t,height:n.b*e+n.d*t}}function S(e,t){return t.a*e}function E(e,t){return t.d*e}function T(e,t,n,o,r=!1){const i=(e,t,n,o=!1)=>{e.beginPath(),e.strokeStyle=`rgba(0,0,255,${o?.05:.2})`,e.lineWidth=2,e.moveTo(t,n),e.lineTo(t,n-20),e.stroke()};e.save(),e.resetTransform(),i(e,t,n,r),o.forEach((o=>i(e,t+o,n,r))),e.restore()}!function(e){e.text="text",e.space="space",e.lineBreak="lineBreak",e.footnoteLink="footnoteLink",e.mention="mention"}(w||(w={})),function(e){e.ordinary="ordinary",e.special="special"}(x||(x={}));const _=(e,t,n,o,r,i=0,s=0,a=!1)=>{e.save(),e.resetTransform(),e.fillStyle=`rgba(221,0,0,${a?.05:.1})`,e.fillRect(t,n,o,10),e.fillStyle=`rgba(221,0,0,${a?.4:.8})`,e.font="10px Arial",e.fillText(`${i}`,t,n+10),e.fillStyle=`rgba(0,128,221,${a?.4:.8})`,e.fillText(`${s}`,t,n+20),T(e,t,n,r,a),e.restore()},A=(e,t,n,o,r,i=!1)=>{e.save(),e.resetTransform(),e.fillStyle=`rgba(0,221,0,${i?.05:.1})`,e.fillRect(t,n+10,o,10),e.restore(),T(e,t,n,r,i)},P=(e,t,n,o=!1)=>{e.save(),e.resetTransform(),e.beginPath(),e.strokeStyle=`rgba(0,221,0,${o?.05:.1})`,e.lineWidth=5,e.moveTo(t+2.5,n),e.lineTo(t+2.5,n+10),e.lineTo(t-10,n+10),e.stroke(),e.restore()},k=(e,t,n,o)=>{e.save(),e.resetTransform(),e.font="12px Arial",e.fillStyle="rgba(0,128,221,0.8)",e.fillText(`${o}`,t,n),e.restore()};function O(e){return(t,n)=>{const o=function(e,t,n){const o=n.slice(0);return o[0]===e?(o.shift(),0===o.length?{shouldStart:!0,newPageCandidate:t.slice(0)}:{shouldStart:!1,newPageCandidate:o}):o.length<t.length?{shouldStart:!1,newPageCandidate:t.slice(0)}:{shouldStart:!1,newPageCandidate:o}}(e,n.newPageRoutine,n.newPageCandidate);o.shouldStart?function(e,t){const n=(o=t.getCurrentPageAttrs(),{pageAttrs:{...o},sections:{main:{fragments:[],specialFragments:[],length:0,wordCount:0},header:{fragments:[],specialFragments:[],length:0,wordCount:0},footer:{fragments:[],specialFragments:[],length:0,wordCount:0},footnotes:{fragments:[],specialFragments:[],length:0,wordCount:0}}});var o;t.currentPageMap=n,t.currentSelection=[],t.pageCleared=!0,t.newPageRoutine=M.slice(0),t.newPageCandidate=M.slice(0),t.matchingBroken=!1,t.pagesMap.set(n.pageAttrs.number,n),t.hasSuggestions=!1;const r=Array.from(t.pagesMap.values()).reduce(((e,t)=>e+(t.pageAttrs.number<n.pageAttrs.number?t.sections.main.length:0)),0);if(t.debugVizualize){const t=C(20,20,e.getTransform());k(e,t.left,t.top,`Text starts at: ${r}`)}t.footnote={footnoteLineDetected:!1},t.compact=t.isCompactLayout()}(t,n):n.newPageCandidate=o.newPageCandidate}}const M=["clearRect","save","scale"];function R(e){if(null===e.clearedRect)return!1;const{left:t,top:n,width:o,height:r}=e.clearedRect,i=e.currentPageMap.pageAttrs.canvasBitmapSize;return!(t<=0&&n<=0&&t+o>=i.width&&n+r>=i.height)}function I(e,t){return!!e.currentPageMap||(e.api.log(t,"Current page map expected"),!1)}function L(e,t,n){n.matchingBroken||(n.matchingBroken=!0,n.api.logError("proxy.fillText","matching is broken",{text:e,fontStyle:t,targetFont:n.font}))}function D(e,t,n,o){const r=G(t,n);if(!r)return null;const i=Y(t,b,n),s=Y(t," ",n);if(!i||!s)return null;return{spaceMetrics:s,fontMetrics:r,top:e.top-E(i.chunk.actualBoundingBoxAscent,o),height:E(i.chunk.actualBoundingBoxAscent+i.chunk.actualBoundingBoxDescent,o)}}function B(e,t,n,{top:o,height:r},i,s){const a=Y(t,e,s);if(!a)return null;const l=S(a.chunk.width,i);return{baseline:n.top,top:o,left:n.left,text:e,width:l,height:r,charShifts:a.charShifts.map((e=>S(e.width,i)))}}function $(e,t,n,o,r,i,s){const a=new RegExp(`^${String.fromCodePoint(8237)}.*${String.fromCodePoint(8236)}$`).test(e),l=/^\d+$/.test(V(e)),c=!a&&!l,u=D(n,t,r,i);if(c){if(u){const s=B(e,t,n,u,i,r);s&&o.specialFragments.push({type:w.mention,class:x.special,...s})}return!0}if(l){const a=V(e);if(s&&u&&v(s)){let e=s,l=o.fragments.length-1;for(let t=o.fragments.length-1;t>0;t--){const r=o.fragments[t];if(r.type===w.lineBreak)break;if(!(r.left>n.left)){e=r,l=t;break}}const c=Math.abs(e.height*z-u.height)<j*u.height,d=Math.abs(e.top-u.top)<u.height*j;if(c&&d){const s=B(a,t,n,u,i,r);if(s){const t={...s,height:e.height,baseline:e.baseline,type:w.footnoteLink,class:x.ordinary,linkText:a,text:"#"};if(function(e){return e.type===w.space}(e)&&function(e,t,n=Number.EPSILON){return e===t||Math.abs(e-t)<n}(e.left,n.left,U))return f(e.width,s.width,U)?o.fragments.splice(l,1,t):o.fragments.splice(l,1,t,{...e,left:e.left+s.width,width:e.width-s.width}),!0;if(Math.abs(s.left-e.left-e.width)<.5*u.spaceMetrics.chunk.width)return o.fragments.splice(l+1,0,t),!0}}}}else if(a&&s&&u&&v(s)){const a=Math.abs(s.height*z-u.height)<j*u.height,l=Math.abs(s.top-u.top)<u.height*j;if(a&&l){const a=B(V(e),t,n,u,i,r);if(a){if(Math.abs(a.left-s.left-s.width)<.5*u.spaceMetrics.chunk.width)return o.fragments.push({...a,height:s.height,baseline:s.baseline,type:w.text,class:x.ordinary}),!0}}}return!1}const F=1,z=.6,j=.1,U=.001,q=192;function V(e){return 8237===e.codePointAt(0)?e.substr(1,e.length-2)||"":e}let H;function W(e){if(void 0===H){const t=document.createElement("canvas");H=t.getContext("2d"),void 0===H&&(e.api.logError("proxy.metrics","Can't create self-measuring canvas"),H=null)}return H}function G(e,t){const{metricsMap:n,api:o}=t,r=n.get(e);if(r)return r;{o.logError("proxy.metrics","No metrics for font");const r=W(t);return r?(r.font=e,r.measureText(`${String.fromCodePoint(8237)}M${String.fromCodePoint(8236)}`),n.get(e)):(o.logError("proxy.metrics","Self-measuring failed for font"),void L(null,e,t))}}function Y(e,t,n){const o=G(e,n);if(o){const r=o.get(t);if(r)return r;{n.api.log("proxy.metrics","No metrics for text");const r=W(n);return r?(r.font=e,r.measureText(`${String.fromCodePoint(8237)}${t}${String.fromCodePoint(8236)}`),o.get(t)):(n.api.logError("proxy.metrics","Self-measuring failed for text"),void L(null,e,n))}}}function Q(e,t,n,o,r,i){var s,a;const l=i.getTransform(),c=C(t,n,l),u=y(null!==(s=r.font)&&void 0!==s?s:i.font),d=o.fragments.length>0?o.fragments[o.fragments.length-1]:null;if($(e,u,c,o,r,l,d))return;const g=V(e),p=d&&((h=d).type===w.text||h.type===w.footnoteLink)?d:null;var h;if(p){const e={top:p.baseline,left:p.left},t=c.left-e.left-p.width,n=c.top-e.top>.2*p.height;!n&&t>F&&(o.fragments.push({type:w.space,class:x.ordinary,baseline:c.top,left:e.left+p.width,top:p.top,width:t,height:p.height}),o.length++,r.debugVizualize&&A(i,e.left+p.width,c.top,t,[])),n&&(o.fragments.push({type:w.lineBreak,class:x.ordinary,baseline:c.top,left:e.left+p.width,top:p.top,height:p.height}),o.length++,r.debugVizualize&&P(i,p.left+p.width,p.top))}const f=D(c,u,r,l);if(!f)return;const m=null!==(a=g.match(/[^\s]+|\s+/g))&&void 0!==a?a:[];for(const e of m){const t=B(e,u,c,f,l,r);if(null==t)continue;const n={type:w.text,class:x.ordinary,...t};o.fragments.push(n),r.debugVizualize&&(e.match(/^\s+$/)?A(i,c.left,c.top,n.width,n.charShifts):_(i,c.left,c.top,t.width,t.charShifts," "===e?void 0:o.wordCount++," "===e?void 0:o.length)),o.length+=e.length,c.left+=n.width}}const X=O("clearRect"),K=O("save"),J={postFn:{fillText(e,t,[n,o,r,i]){if(!I(t,"proxy.fillText"))return;if(R(t))return;const s=function(e){if(e.compact)return 0;const{clips:t}=e;if(1===t.length)return e.currentPageMap?n(t[0],{...e.currentPageMap.pageAttrs.canvasBitmapSize,left:0,top:0}):0;if(2===t.length){const[e,o]=t;return n(o,e)}return 0;function n(e,t){return e.left!==t.left||e.width!==t.width?0:0===e.top&&e.height<t.height?1:e.top>t.top?2:0}}(t);Q(n,o,r,1===s?t.currentPageMap.sections.header:2===s?t.currentPageMap.sections.footer:t.currentPageMap.sections.main,t,e)},fillRect(e,t,[n,o,r,i]){if(["rgba(118, 167, 250, 0.5)","rgba(118, 167, 250, 0.501960784313726)"].includes(e.fillStyle)){const s=e.getTransform();t.currentSelection.push({...C(n,o,s),...N(r,i,s)})}},clearRect(e,t,n){X(e,t),t.clips.length||(t.clearedRect=Z(e,n))},save(e,t){t.saveCount++,t.savedState.push({font:t.font,clips:[...t.clips]}),K(e,t)},scale:O("scale"),restore(e,t){const n=t.savedState.pop();n&&(t.font=n.font,t.clips=n.clips),t.saveCount--,0===t.saveCount&&t.currentPageMap&&(t.hasSuggestions&&t.onChangeMode("suggest"),I(t,"proxy.restore")&&t.onRender({pageMap:R(t)?null:{...t.currentPageMap},pageAttrs:t.currentPageMap.pageAttrs,selection:t.currentSelection,hasSuggestions:t.hasSuggestions}))},moveTo(e,t,[n,o]){t.footnote.footnoteLineDetected||(t.footnote.lastPosition={left:n,top:o})},lineTo(e,t,[n,o]){!function(e,t,n){if(!e.footnote.footnoteLineDetected){const o=e.footnote.lastPosition;if(o){const r=t-o.left;n>0&&Math.abs(o.top-n)<F&&r===q&&(e.footnote={footnoteLineDetected:!0,footnoteLinePosition:o})}}e.footnote.footnoteLineDetected||(e.footnote.lastPosition={left:t,top:n})}(t,n,o)},beginPath(e,t){t.path=[]},clip(e,t,n){n[0]?t.api.logError("proxy.clip:unexpectedArguments","clip with parameters is not supported"):1!==t.path.length?t.api.logError("proxy.clip:unsupportedPath","clip with multiple paths is not supported",{pathSize:t.path.length}):t.clips.push(t.path[0])},rect(e,t,n){t.path.push(Z(e,n))}},overrideSet:{strokeStyle:(e,t,n)=>"rgba(221,0,0,1)"===n||"rgba(66,133,244,1)"===n?"rgba(0,0,0,0)":void 0,fillStyle:(e,t,n)=>"rgba(252,232,230,1)"===n||"rgba(232,240,254,1)"===n?"rgba(0,0,0,0)":void("rgba(31,161,93,1)"===n&&(t.hasSuggestions=!0)),font(e,t,n){t.font=n}}};function Z(e,[t,n,o,r]){const i=e.getTransform();return{...C(t,n,i),...N(o,r,i)}}const ee=new Set(["version","title","lang","translate","dir","dataset","hidden","tabIndex","accessKey","draggable","spellcheck","contentEditable","isContentEditable","offsetParent","offsetTop","offsetLeft","offsetWidth","offsetHeight","style","innerText","outerText","onabort","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextmenu","oncuechange","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onpause","onplay","onplaying","onprogress","onratechange","onreset","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onsubmit","onsuspend","ontimeupdate","ontoggle","onvolumechange","onwaiting","onwheel","ongotpointercapture","onlostpointercapture","onpointerdown","onpointermove","onpointerup","onpointercancel","onpointerover","onpointerout","onpointerenter","onpointerleave","click","focus","blur","onauxclick","nonce","namespaceURI","prefix","localName","tagName","id","className","classList","slot","attributes","shadowRoot","assignedSlot","innerHTML","outerHTML","scrollTop","scrollLeft","scrollWidth","scrollHeight","clientTop","clientLeft","clientWidth","clientHeight","onbeforecopy","onbeforecut","onbeforepaste","oncopy","oncut","onpaste","onsearch","onselectstart","previousElementSibling","nextElementSibling","children","firstElementChild","lastElementChild","childElementCount","onwebkitfullscreenchange","onwebkitfullscreenerror","setPointerCapture","releasePointerCapture","hasPointerCapture","hasAttributes","getAttributeNames","getAttribute","getAttributeNS","setAttribute","setAttributeNS","removeAttribute","removeAttributeNS","hasAttribute","hasAttributeNS","getAttributeNode","getAttributeNodeNS","setAttributeNode","setAttributeNodeNS","removeAttributeNode","closest","matches","webkitMatchesSelector","attachShadow","getElementsByTagName","getElementsByTagNameNS","getElementsByClassName","insertAdjacentElement","insertAdjacentText","insertAdjacentHTML","requestPointerLock","getClientRects","getBoundingClientRect","scrollIntoView","scrollIntoViewIfNeeded","createShadowRoot","getDestinationInsertionPoints","animate","remove","querySelector","querySelectorAll","webkitRequestFullScreen","webkitRequestFullscreen","scroll","scrollTo","scrollBy","before","after","replaceWith","prepend","append","ELEMENT_NODE","ATTRIBUTE_NODE","TEXT_NODE","CDATA_SECTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","PROCESSING_INSTRUCTION_NODE","COMMENT_NODE","DOCUMENT_NODE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","NOTATION_NODE","DOCUMENT_POSITION_DISCONNECTED","DOCUMENT_POSITION_PRECEDING","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_CONTAINS","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC","nodeType","nodeName","baseURI","isConnected","ownerDocument","parentNode","parentElement","childNodes","firstChild","lastChild","previousSibling","nextSibling","nodeValue","textContent","hasChildNodes","getRootNode","normalize","cloneNode","isEqualNode","isSameNode","compareDocumentPosition","contains","lookupPrefix","lookupNamespaceURI","isDefaultNamespace","insertBefore","appendChild","replaceChild","removeChild","addEventListener","removeEventListener","dispatchEvent"]),te=["autocorrect","comment","composing_decoration","composing_region","draft_comment","ignore_spellcheck","ignore_word","import_warnings","link","named_range","revision_diff","smart_todo","spellcheck","suppress_feature","text","voice_corrections","voice_dotted_span","autogen","cell","citation_sources","column_sector","date_time","document","equation","equation_function","footnote","headings","horizontal_rule","language","list","paragraph","row","tbl"],ne=[61439,61438,59651,26,30,59649,3,59653,59652,16,17],oe=[47,91,61439,61438,59651,26,30,59649,3,59653,59652,16,17,93,47,103].reduce(((e,t)=>e+String.fromCharCode(t)),""),re=[47,91,28,3,59653,59651,26,25,31,92,110,18,16,93,47,103].reduce(((e,t)=>e+String.fromCharCode(t)),"");class ie extends Error{constructor(e){super(`Assertion failed: ${e?"string"==typeof e?e:e():"(unnamed)"}`)}}function se(e,t){if(null==e)throw new ie((()=>t?`Expected ${t} to be non-null`:"Expected non-null"));return e}function ae(e,t,n,o=Object.getOwnPropertyNames(e)){const r=new Set,i=[];let s=0;const a=(o,l,c,u=0)=>{if(s++,"prototype"===o||l instanceof Window)return;if(u>n)return;const d=[...c,o];try{if(t(o,l))return void i.push({path:d,value:l})}catch(e){}var g;if(null!=l&&!r.has(l))if(r.add(l),Array.isArray(l))l.forEach(((e,t)=>{try{a(t.toString(),e,d,u+1)}catch(e){}}));else if(l instanceof Object){((g=l)&&null!==g&&1===g.nodeType&&"string"==typeof g.nodeName?Object.getOwnPropertyNames(e).filter((e=>!ee.has(e))):Object.getOwnPropertyNames(l)).forEach((e=>{try{a(e,l[e],d,u+1)}catch(e){}}))}};return o.forEach((t=>{try{a(t,e[t],[])}catch(e){}})),{results:i,iterations:s}}function le(e){const t=se(Object.getOwnPropertyNames(e).find((e=>-1!==e.toString().indexOf("_kixApp")))),n=se(e[t],"kixApp"),o=function(e,t){const n=new Set;return e.filter((e=>{const o=t(e);return!n.has(o)&&(n.add(o),!0)}))}(ae(n,((e,t)=>t&&""===t.toString().charAt(0)),5).results,(e=>e.value)).filter((e=>isNaN(parseInt(e.path[e.path.length-1],10)))).reduce(((e,o)=>{const r=o.path.slice(0,o.path.length-1).reduce(((e,t)=>e[t]),n),i=ae(r,((e,t)=>t instanceof RegExp),1);let s=!1,a=!1;if(1===i.results.length){const e=i.results[0].value;s=e.toString()===re,a=e.toString()===oe}else{1===ae(r,((e,t)=>Array.isArray(t)&&t.length===ne.length&&t.every(((e,t)=>e.charCodeAt(0)===ne[t]))),1).results.length&&(a=!0)}return s?{...e,headersAndFooters:[t].concat(o.path)}:a?{...e,text:[t].concat(o.path)}:e}),{text:[],headersAndFooters:[]});return 0===o.text.length?null:o}function ce(e,t,n){return e.push(Array.isArray(t)||isNaN(t)?n:t),e}class ue{constructor(e){this._win=e,this._result=null,this._resizer=null}_attemptTextExtraction(){try{const e=le(this._win),t=Boolean(null==e?void 0:e.headersAndFooters.length),n=function(e){const t=se(Object.getOwnPropertyNames(e).find((e=>-1!==e.toString().indexOf("_kixApp")))),n=ae(se(e[t],"kixApp"),((e,t)=>"horizontal_rule"===e&&2===Object.keys(t).length),6);return[t].concat(se(n.results[0]).path,Object.keys(n.results[0].value)[0])}(this._win),{inline:o,positioned:r}=function(e){try{const t=se(Object.getOwnPropertyNames(e).find((e=>-1!==e.toString().indexOf("_kixApp")))),n=se(e[t],"kixApp"),o=se(ae(n,((e,t)=>"inline"===e&&"object"==typeof t),5).results[0]);o.path.pop();const r=se(o.path).reduce(((e,t)=>e[t]),n),i=se(r.inline),s=r.positioned,a=(e,n)=>{const r=ae(e,((e,t)=>2===Object.keys(t).length),5);return[t].concat(o.path,n,se(r.results[0]).path,Object.keys(r.results[0].value)[0])};return{inline:a(i,"inline"),positioned:s?a(s,"positioned"):null}}catch(e){return{inline:null,positioned:null}}}(this._win),i=(null==e?void 0:e.text)||[],s=i.pop(),a=i.reduce(((e,t)=>e[t]),this._win),l=(null==e?void 0:e.headersAndFooters)||[],c=l.pop(),u=l.reduce(((e,t)=>e[t]),this._win),d=null==n?void 0:n.pop(),g=n?null==n?void 0:n.reduce(((e,t)=>e[t]),this._win):{},p=Array.isArray(o)&&o.pop(),h=Array.isArray(r)&&r.pop(),f=o&&o.reduce(((e,t)=>e[t]),this._win),m=r&&r.reduce(((e,t)=>e[t]),this._win);if(i.length>0){const{suggestionsFullArrayPath:e}=function(e,t){try{const n=se(Object.getOwnPropertyNames(e).find((e=>-1!==e.toString().indexOf("_kixApp")))),o=ae(se(e[n],"kixApp"),((e,t)=>t&&Array.isArray(t)&&t.some((e=>Array.isArray(e)&&-1!==e.toString().indexOf("suggest.")))),10).results.filter((e=>e.path[0]===t[1])).filter((e=>!te.some((t=>e.path.includes(t))))).map((e=>{const t=[...e.path];return t.pop(),t})).reduce(((t,o)=>{const r=[n].concat(o).reduce(((e,t)=>e[t]),e);return t?r[t.idProp]>t.id?{...t,id:r[t.idProp],path:o}:t:Object.getOwnPropertyNames(r).reduce(((e,t)=>Array.isArray(r[t])||isNaN(parseInt(r[t],10))?Array.isArray(r[t][0])?{...e,fullArrayProp:t}:{...e,compactArrayProp:t}:{...e,idProp:t,id:r[t]}),{path:o})}),null);return{suggestionsFullArrayPath:o?[n].concat(o.path,o.fullArrayProp):null}}catch(e){return{suggestionsFullArrayPath:null}}}(this._win,i),n=Array.isArray(e)&&e.pop(),o=e&&e.reduce(((e,t)=>e[t]),this._win);return{getText:()=>{const e=a[s],r=t?u[c]:"",i=g[d],l=Array.isArray(i)?i.reduce(ce,[]).sort(((e,t)=>e-t)):[],b=f&&p&&f[p],y=Array.isArray(b)&&b.reduce(ce,[])||[],w=m&&h&&m[h],x=Array.isArray(w)&&w.reduce(ce,[])||[],v=o&&n&&o[n];if("string"==typeof e)return v?{fullText:e,headersAndFootersText:r,ignoredRanges:[...v].reduce(((e,t)=>(e.push(Array.isArray(t)?!!t[0]:!!e.length&&e[e.length-1]),e)),[]),nonTextEntities:{horizontal_rule:{startsAt:l,textRepresentation:"-\n"},inline_image:{startsAt:y,textRepresentation:"*"},positioned_image:{startsAt:x,textRepresentation:"*"}}}:{fullText:e,headersAndFootersText:r,ignoredRanges:[],nonTextEntities:{horizontal_rule:{startsAt:l,textRepresentation:"-\n"},inline_image:{startsAt:y,textRepresentation:"*"},positioned_image:{startsAt:x,textRepresentation:"*"}}};throw new Error("unexpected text value type")},gotIgnoredRanges:!!o}}return{error:"notFound"}}catch(e){return{error:"exception",message:e.message}}}_attemptResizerExtraction(){const e=function(e){try{return[se(Object.getOwnPropertyNames(e).find((e=>-1!==e.toString().indexOf("_kixApp"))))].concat("resize")}catch(e){return null}}(this._win);try{return e?e.reduce(((e,t)=>e[t]),this._win):()=>{}}catch(e){return()=>{}}}_getText(e){try{return this._result||(this._result=this._attemptTextExtraction()),e.reQueryForIgnoredRanges&&"getText"in this._result&&!this._result.gotIgnoredRanges&&(this._result=this._attemptTextExtraction()),"getText"in this._result?this._result.getText():null}catch(e){return null}}getText(e){return this._getText(e)}triggerRender(){try{this._resizer||(this._resizer=this._attemptResizerExtraction()),this._resizer()}catch(e){}}}class de{constructor(e,t){this._transport=e,this._log=t,this._calls=new Map,this._sub=this._transport.inbound.subscribe((e=>{var t;const n=this._calls.get(e.id);if(n)try{"err"in e?n.reject(e.err):n.resolve(e.res)}finally{this._calls.delete(e.id)}else null===(t=this._log)||void 0===t||t.warn(`received rpc call response for unregistered call ${e.id}`)})),this.api=new Proxy({},{get:(e,t)=>"then"===t?void 0:(...e)=>this._handleCall(t,e)})}_handleCall(e,n){let o=t.create();for(;this._calls.has(o);)o=t.create();const r=i.createCompletionSource();return this._calls.set(o,r),this._transport.outbound({id:o,method:e,args:n}),r.promise}dispose(){this._sub.unsubscribe()}}const ge=(t,o)=>(r,i)=>{const{request:s,response:l}=function(e){return{request:`cs-grm-request-${e}`,response:`cs-grm-response-${e}`}}(t),c=new de(new h(document,l,s)),u=new Map,d=()=>document.querySelector(`.${a.canvasLayoutRootClass}`);!async function(){var t;try{const s=null!==(t=d())&&void 0!==t?t:await async function(){for(;;){await n(250);const e=d();if(e)return e}}();if(!s)throw new Error("Cannot find rotating tile manager");const a=function(){const e=[];function t(t,n){e[t]=n}return{identifyPage(n,o){const r=n.top+n.height+18>=o.height;let i=0,s=-1;for(;i<=n.top;){if(i+18>n.top)return t(s+1,n),r&&e.length>s+2&&e.splice(s+2),{number:s+1,isLastPage:r};s++,i=e[s]?e[s].top+e[s].height:Math.min(i+n.height,n.top)}return{number:void 0,isLastPage:r}}}}(),l=function(e,t){const n=new ue(self);let o,r=!1,i=!1;const s=new Map;return{onChangeMode(e){o!==e&&(o=e,"suggest"===o&&(r=!1,i=!1,a(e)))},onRender(o){if(r||i){const r=i?null:n.getText({reQueryForIgnoredRanges:o.hasSuggestions});e.pageRendered({fullText:r,renderResult:o},t)}else s.set(o.pageAttrs.number,o)},init:()=>a(void 0)};function a(o){setTimeout((()=>{if(r||i)return;if(o!=o)return;const a=n.getText({reQueryForIgnoredRanges:!0});if(null===a?(i=!0,e.logError("FullTextExtractor","Cannot get full document text")):r=!0,s.size){const n=s.values();for(const o of n)e.pageRendered({fullText:a,renderResult:o},t);s.clear()}else n.triggerRender()}),0)}}(c.api,o);r((e=>{if(function(e){return Boolean(e.className)}(e)){const t=function(e){return{...e,pageCleared:!1,matchingBroken:!1,currentSelection:[],pagesMap:e.pagesMap||new Map,metricsMap:e.metricsMap||new Map,newPageRoutine:M.slice(0),newPageCandidate:M.slice(0),saveCount:0,savedState:[],path:[],clips:[],clearedRect:null,hasSuggestions:!1,footnote:{footnoteLineDetected:!1},compact:!1}}({api:c.api,metricsMap:i.metricsMap,pagesMap:u,getCurrentPageAttrs(){const t=s.getBoundingClientRect(),{left:n,top:o,width:r,height:i}=e.getBoundingClientRect(),l={left:n-t.left,top:o-t.top,width:r,height:i},{number:u,isLastPage:d}=a.identifyPage(l,t);return void 0===u&&c.api.logError("pageManager.identifyPage","Cannot identify page number",{rect:l}),{number:null!=u?u:-1,isLastPage:d,canvasBitmapSize:{width:e.width,height:e.height},pageOffsetRect:l}},isCompactLayout(){var t;return!!(null===(t=e.parentElement)||void 0===t?void 0:t.classList.contains("kix-page-canvas-compact-mode"))},onChangeMode:l.onChangeMode,onRender:l.onRender});return function({api:e,state:t}){return m(t,J,e)}({api:c.api,state:t})}}));await e(10,0,(()=>{return e=400,t=c.api.init(),Promise.race([g(e),t]);var e,t}))&&l.init(),await n(1e3),i.metricsMap.size||await c.api.logError("init.textMeasuringCheck","No text measuring events received")}catch(e){try{await c.api.logException("init",e)}catch(e){}}}()};!async function(){var e;try{const t=document.documentElement.dataset.grGdcConnId||(document.documentElement.dataset.grGdcConnId=`${Date.now()}-${Math.random()}`),n=self[`GR_GDEI_${t}`];if(!n)return void console.error("Could not start grammarly integration","no early injected data found");const o=(null===(e=document.currentScript)||void 0===e?void 0:e.getAttribute("data-ext-version"))||"unknown";ge(t,o)(n.addMiddleware,n.textMeasuringState)}catch(e){console.error("Could not start grammarly integration","module not loaded",e)}}()}();