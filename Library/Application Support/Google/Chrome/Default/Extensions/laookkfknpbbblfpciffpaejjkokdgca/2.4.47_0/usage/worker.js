(()=>{var t={528:(t,e,n)=>{"use strict";n.d(e,{Z:()=>T});const o="http://momentumdash.com/local-cache-key/",c={uuidv4:function(){const t=[];for(let e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);const e=crypto.getRandomValues(new Uint8Array(16));return e[6]=15&e[6]|64,e[8]=63&e[8]|128,t[e[0]]+t[e[1]]+t[e[2]]+t[e[3]]+"-"+t[e[4]]+t[e[5]]+"-"+t[e[6]]+t[e[7]]+"-"+t[e[8]]+t[e[9]]+"-"+t[e[10]]+t[e[11]]+t[e[12]]+t[e[13]]+t[e[14]]+t[e[15]]},getFromCache:async function(t){const e=await caches.open("modash-cache"),n=await e.match(o+t);let c=null;return n&&(c=await n.json()),c},setCache:async function(t,e){const n=await caches.open("modash-cache");await n.put(o+t,new Response(e))},deleteCache:async function(t){const e=await caches.open("modash-cache");await e.delete(o+t)},getDateString:function(t){return void 0===t?t=new Date:t instanceof Date||(t=new Date(t)),t.getHours()<4&&t.setDate(t.getDate()-1),t.getFullYear().toString()+"-"+this.twoDigit(t.getMonth()+1)+"-"+this.twoDigit(t.getDate())},twoDigit:function(t){const e=parseInt(t);return(e>=10?e:"0"+e.toString()).toString()}},r=function(){let t=null,e=null;const n={READY:"ready",UPLOADING:"uploading",UPLOADED:"uploaded"};function o(){return new Promise((function(n,c){try{t?n(t):(function(){try{const n=indexedDB.open("momo-db",1);n.onsuccess=function(){t=n.result},n.onupgradeneeded=function(o){!function(n,o){try{n.oncomplete=function(){t=o},e=o.createObjectStore("usage",{keyPath:"key"}),e.createIndex("ready",["forDate","itemUuid","status"])}catch(t){console.error(t)}}(o.target.transaction,n.result)}}catch(t){console.error(t)}}(),setTimeout((function(){o().then((function(t){n(t)}))}),10))}catch(t){c(t)}}))}return{status:n,increment:function(t,e,r,a){let i=null;o().then((function(o){try{const s=o.transaction(["usage"],"readwrite"),u=c.getDateString();s.objectStore("usage").index("ready").get([u,t,n.READY]).onsuccess=function(n){try{i=void 0===n.target.result?T.create(t,e):n.target.result,Array.isArray(r)||(r=[r]),r.forEach((function(t){i[t]++})),s.objectStore("usage").put(i),a&&a(n.target.result)}catch(t){console.error(t)}}}catch(t){console.error(t)}}))},saveEntity:function(t){const e={};return Object.assign(e,t),e.key=c.uuidv4(),e.status=n.READY,new Promise((function(t,n){o().then((function(o){try{const c=o.transaction(["usage"],"readwrite");c.oncomplete=function(e){t(e)},c.onerror=function(t){n(t)},c.objectStore("usage").put(e)}catch(t){n(t)}}))}))},prepareUnsynced:function(){return new Promise((function(t,e){o().then((function(o){try{const c=o.transaction(["usage"],"readwrite");c.oncomplete=function(){t(s)};const r=(new Date).getTime(),a=r-6e4,i=c.objectStore("usage"),s=[];let u=50;i.openCursor().onsuccess=function(t){try{let e=t.target.result;if(e&&u>0){if(e.value.status===n.READY||e.value.uploadDate<a){u--;const t=e.value;t.status=n.UPLOADING,t.uploadDate=r,e.update(t).onsuccess=function(){s.push(t)}}e.continue()}}catch(t){e()}}}catch(t){e()}})).catch((function(){e()}))}))},cleanSynced:function(t){return new Promise((function(e,n){o().then((function(o){try{const c=o.transaction(["usage"],"readwrite");c.oncomplete=function(){e()},c.objectStore("usage").openCursor().onsuccess=function(e){try{const n=e.target.result;n&&(t.map((function(t){n.value.key===t&&n.delete()})),n.continue())}catch(t){n(t)}}}catch(t){n(t)}})).catch((function(){n()}))}))}}}();let a=null,i=null,s=null,u=null;const d={PHOTO:1,QUOTE:2,MANTRA:3,ERROR:4,SEARCH:5,STATS:6,TIMING:7,SYSTEM:8,PHOTO_LOAD:9},l={IMPRESSION_COUNT:"impressionCount",HOVER_COUNT:"hoverCount",LOAD_COUNT:"loadCount",CLICK_COUNT:"clickCount",SECONDARY_CLICK_COUNT:"secondaryClickCount",ADMIRE_COUNT:"admireCount",STICKY_CLICK_COUNT:"stickyClickCount",STICKY_SECONDARY_CLICK_COUNT:"stickySecondaryClickCount",STICKY_HOVER_COUNT:"stickyHoverCount"},C={[d.PHOTO]:[l.IMPRESSION_COUNT,l.HOVER_COUNT,l.LOAD_COUNT,l.ADMIRE_COUNT,l.CLICK_COUNT,l.STICKY_CLICK_COUNT,l.SECONDARY_CLICK_COUNT,l.STICKY_SECONDARY_CLICK_COUNT,l.STICKY_HOVER_COUNT],[d.QUOTE]:[l.IMPRESSION_COUNT,l.HOVER_COUNT,l.LOAD_COUNT,l.CLICK_COUNT]},f="usage-retry-after",O={updateInterval:6e4,["loaded"+d.PHOTO]:null,["loaded"+d.QUOTE]:null,["trackedLoaded"+d.PHOTO]:null,["trackedLoaded"+d.QUOTE]:null},h={properties:l,types:d,create:function(t,e){const n={itemUuid:t,type:e,forDate:c.getDateString(),status:r.status.READY,uploadDate:0,key:c.uuidv4()};return C[e].forEach((function(t){n[t]=0})),n},newTabLoaded:function(){O.loadComplete=!0,Object.values(d).forEach((function(t){const e=O["loaded"+t];e&&h.recordImpression(e,t)}))},setup:function(t,e,n,o){s=t,u=e,i=o,a=n,h.sendStats()},itemLoaded:function(t,e,n){O["loaded"+e]=t,!n&&O.loadComplete&&h.recordImpression(t,e)},savePhotoError:function(t){t.itemType="Photo",this.saveError(t,!0,!0)},saveError:function(t){t.type=d.ERROR,navigator.connection&&(t.rtt=navigator.connection.rtt,t.down=navigator.connection.downlink),this.save(t,!0,!0)},savePhotoLoad:function(t){t.type=d.PHOTO_LOAD,navigator.connection&&(t.rtt=navigator.connection.rtt,t.down=navigator.connection.downlink),this.save(t,!0,!1)},save:function(t,e,n){t.date=(new Date).getTime(),t.type||(t.type=d.STATS),r.saveEntity(t).then((function(){e&&!n&&h.sendStats()}))},increment:function(t,e,n,o){r.increment(t,e,n,(function(){o&&h.sendStats()}))},recordStickyHover:function(t,e){this.increment(t,e,[l.HOVER_COUNT,l.STICKY_HOVER_COUNT])},recordHover:function(t,e){this.increment(t,e,l.HOVER_COUNT)},recordClick:function(t,e,n){this.increment(t,e,l.CLICK_COUNT,n)},recordStickyClick:function(t,e,n){this.increment(t,e,[l.CLICK_COUNT,l.STICKY_CLICK_COUNT],n)},recordSecondaryClick:function(t,e,n){this.increment(t,e,l.SECONDARY_CLICK_COUNT,n)},recordStickySecondaryClick:function(t,e,n){this.increment(t,e,[l.SECONDARY_CLICK_COUNT,l.STICKY_SECONDARY_CLICK_COUNT],n)},recordImpression:function(t,e){this.increment(t,e,l.IMPRESSION_COUNT)},recordAdmire:function(t){this.increment(t,d.PHOTO,l.ADMIRE_COUNT)},sendStats:function(){O.sendingScheduled=!1,a&&(O.sending?O.sendingScheduled=!0:(O.sending=!0,setTimeout((async()=>{const t=await r.prepareUnsynced();await async function(t){try{if(!t||0===t.length||!navigator.onLine)return void(O.sending=!1);let e=await c.getFromCache(f);if(e){if((new Date).getTime()<parseInt(e))return void(O.sending=!1);e=null}t.forEach((t=>{C[t.type]&&C[t.type].forEach((e=>{0===t[e]&&delete t[e]})),isNaN(t.type)&&(t.type=t.type===h.types.PHOTO?1:2),delete t.status,delete t.uploadDate}));const n=await fetch(s+"collect",{method:"post",headers:p(),body:JSON.stringify(t)});if(n.ok){let t=await n.json();t&&await r.cleanSynced(t),setTimeout((()=>{O.sendingScheduled&&h.sendStats()}),2e3)}else if(503===n.status){let t=n.headers.get("Retry-After");t&&(t=parseInt(t),c.setCache(f,(new Date).getTime()+1e3*t))}}catch(t){console.error(t)}finally{O.sending=!1}}(t)}),1e3)))}};function p(){const t={"Content-Type":"application/json","X-Momentum-Version":u};return i&&(t.Authorization="Bearer "+i),a&&(t["X-Momentum-ClientId"]=a),t}setInterval(h.sendStats,O.updateInterval);const T=h}},e={};function n(o){if(e[o])return e[o].exports;var c=e[o]={exports:{}};return t[o](c,c.exports,n),c.exports}n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{let t;t=n(528).Z,self.addEventListener("connect",(e=>{e.ports[0].onmessage=function(e){const n=e.data,o=n.func,c=n.params;t[o](...c)}}))})()})();